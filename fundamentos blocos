Tema: Fundamentos e Blocos AnÃ´nimos

ğŸ¯ Objetivos de Aprendizagem
Ao final deste encontro, o aluno deverÃ¡ ser capaz de:
Compreender o que Ã© PL/SQL e suas vantagens.


Estruturar e executar blocos PL/SQL anÃ´nimos.

Declarar variÃ¡veis e constantes.

Utilizar estruturas condicionais e de repetiÃ§Ã£o.

Exibir informaÃ§Ãµes com DBMS_OUTPUT.


ğŸ“– 1. IntroduÃ§Ã£o ao PL/SQL
PL/SQL (Procedural Language/SQL) Ã© a linguagem procedural da Oracle, que combina o poder do SQL com estruturas de programaÃ§Ã£o, permitindo:
Controle de fluxo (condiÃ§Ãµes e laÃ§os);


DeclaraÃ§Ã£o de variÃ¡veis e constantes;


Tratamento de exceÃ§Ãµes (erros);


CriaÃ§Ã£o de procedures, functions e triggers;


ExecuÃ§Ã£o de blocos anÃ´nimos diretamente no SQL Developer ou SQL*Plus.



ğŸ§± Estrutura de um Bloco PL/SQL
DECLARE
   -- DeclaraÃ§Ã£o de variÃ¡veis, constantes, cursores, etc.
BEGIN
   -- Comandos executÃ¡veis (SQL e PL/SQL)
EXCEPTION
   -- Tratamento de erros (opcional)
END;

ğŸ”¹ ObservaÃ§Ã£o:
 Cada bloco PL/SQL termina com END; e deve conter pelo menos a parte BEGIN ... END;.
 O DECLARE e o EXCEPTION sÃ£o opcionais.

ğŸ§  2. Declarando VariÃ¡veis e Constantes
DECLARE
   v_nome       VARCHAR2(30);
   v_idade      NUMBER := 25;
   c_taxa       CONSTANT NUMBER := 0.05;
BEGIN
   v_nome := 'Vilson';
   DBMS_OUTPUT.PUT_LINE('Nome: ' || v_nome);
   DBMS_OUTPUT.PUT_LINE('Idade: ' || v_idade);
   DBMS_OUTPUT.PUT_LINE('Taxa: ' || c_taxa);
END;

ğŸ”¹ Tipos mais usados:
VARCHAR2(tamanho) â€” texto


NUMBER(p,s) â€” nÃºmeros


DATE â€” datas


BOOLEAN â€” valores lÃ³gicos (TRUE, FALSE, NULL)


ğŸ”¹ AtribuiÃ§Ã£o:
Direta: v_nome := 'Ana';


Em SELECT:

 SELECT salario INTO v_salario FROM empregados WHERE id = 1;



ğŸ§° 3. Uso do DBMS_OUTPUT
O pacote DBMS_OUTPUT serve para exibir informaÃ§Ãµes no console.
Antes de usar, ative a saÃ­da no SQL Developer:
SET SERVEROUTPUT ON

Exemplo:
BEGIN
  DBMS_OUTPUT.PUT_LINE('OlÃ¡, PL/SQL!');
END;

SaÃ­da esperada:
OlÃ¡, PL/SQL!


ğŸ”„ 4. Estruturas de Controle
âœ… IF / ELSIF / ELSE
DECLARE
  v_idade NUMBER := 20;
BEGIN
  IF v_idade < 18 THEN
    DBMS_OUTPUT.PUT_LINE('Menor de idade');
  ELSIF v_idade < 60 THEN
    DBMS_OUTPUT.PUT_LINE('Adulto');
  ELSE
    DBMS_OUTPUT.PUT_LINE('Idoso');
  END IF;
END;


ğŸ” LOOP
DECLARE
  v_cont NUMBER := 1;
BEGIN
  LOOP
    DBMS_OUTPUT.PUT_LINE('Contador: ' || v_cont);
    v_cont := v_cont + 1;
    EXIT WHEN v_cont > 5;
  END LOOP;
END;


ğŸ” WHILE LOOP
DECLARE
  v_num NUMBER := 1;
BEGIN
  WHILE v_num <= 3 LOOP
    DBMS_OUTPUT.PUT_LINE('NÃºmero: ' || v_num);
    v_num := v_num + 1;
  END LOOP;
END;


ğŸ” FOR LOOP
BEGIN
  FOR i IN 1..5 LOOP
    DBMS_OUTPUT.PUT_LINE('Valor: ' || i);
  END LOOP;
END;


âš™ï¸ 5. Tipos de Blocos em PL/SQL
Bloco AnÃ´nimo:


Criado e executado diretamente, nÃ£o fica armazenado no banco.


Exemplo:

 BEGIN
  DBMS_OUTPUT.PUT_LINE('Bloco anÃ´nimo executado!');
END;


Bloco Nomeado (Procedures, Functions, Triggers):


Armazenado no banco e reutilizÃ¡vel (veremos nos prÃ³ximos encontros).



ğŸ§© 6. Usando %TYPE e %ROWTYPE
%TYPE
Permite declarar variÃ¡veis com o mesmo tipo de uma coluna:
DECLARE
  v_salario empregados.salario%TYPE;
BEGIN
  SELECT salario INTO v_salario FROM empregados WHERE id = 10;
  DBMS_OUTPUT.PUT_LINE('SalÃ¡rio: ' || v_salario);
END;

%ROWTYPE
Permite armazenar uma linha inteira de uma tabela:
DECLARE
  v_emp empregados%ROWTYPE;
BEGIN
  SELECT * INTO v_emp FROM empregados WHERE id = 10;
  DBMS_OUTPUT.PUT_LINE('Nome: ' || v_emp.nome || ' - SalÃ¡rio: ' || v_emp.salario);
END;


ğŸ§® Lista de Atividades â€“ Encontro 1
ğŸ”¹ Atividade 1 â€“ Primeiro Bloco
Crie um bloco PL/SQL que exiba:
OlÃ¡, Mundo do PL/SQL!


ğŸ”¹ Atividade 2 â€“ DeclaraÃ§Ã£o de VariÃ¡veis
Crie um bloco que:
Declare duas variÃ¡veis: v_nome e v_idade;


Atribua valores;


Exiba:

 Nome: <nome> - Idade: <idade>


ğŸ”¹ Atividade 3 â€“ Estrutura Condicional
Crie um bloco que leia uma variÃ¡vel v_media e exiba:
â€œAprovadoâ€ se maior ou igual a 7


â€œRecuperaÃ§Ã£oâ€ se entre 5 e 6,9

â€œReprovadoâ€ caso contrÃ¡rio

ğŸ”¹ Atividade 4 â€“ Loop
Crie um bloco que exiba os nÃºmeros de 1 a 10.

ğŸ”¹ Atividade 5 â€“ Loop com CondiÃ§Ã£o
Crie um loop que some os nÃºmeros de 1 a 5 e exiba o total:
Soma total: 15

ğŸ”¹ Atividade 6 â€“ Uso de %TYPE
Crie uma variÃ¡vel que receba o mesmo tipo de uma coluna (ex: salario) de uma tabela empregados e exiba seu valor.
ğŸ”¹ Atividade 7 â€“ Mini Desafio
Crie um bloco que:
Declare uma variÃ¡vel v_nome_func


Busque o nome do funcionÃ¡rio com id = 1 da tabela empregados
Exiba:

 FuncionÃ¡rio: <nome_func>

